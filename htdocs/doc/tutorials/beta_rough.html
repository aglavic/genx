<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Beta Roughness Model &#8212; GenX 2.4.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootswatch-3.3.6/flatly/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.4.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/genx.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Using GenX from the command line (with mpi)" href="mpi.html" />
    <link rel="prev" title="Surface X-diffraction tutorial" href="sxrd.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          GenX</a>
        <span class="navbar-text navbar-version pull-left"><b>2.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Content <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#windows">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#mac-os-x">Mac OS-X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#from-source">From source</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#reflectivity">Reflectivity</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#surface-x-ray-diffraction">Surface x-ray diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#other-tutorials">Other tutorials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#fitting">Fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html#reflectivity">Reflectivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/data.html">Data classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/write_data_loader.html">How to write a Data Loader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/write_fom.html">Writing a FOM function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/packaging.html">How to package GenX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/mag_refl.html">A model for magnetic reflectivity</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Beta Roughness Model</a><ul>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="beta-roughness-model">
<span id="beta-rough-model"></span><h1>Beta Roughness Model<a class="headerlink" href="#beta-roughness-model" title="Permalink to this headline">¶</a></h1>
<p>This tutorial describes how to incorporate the general roughness model for crystal truncation rod data
after Robinson <a class="reference internal" href="#rob86" id="id1">[ROB86]</a>.</p>
<p>To use this roughness model you will need the following:</p>
<ol class="arabic">
<li><p class="first">Data file that includes L-value of nearest Bragg peak (LB) and distance in reciprocal lattice units between adjacent
Bragg peaks (dL) for each data point. If dL is the same for all Bragg peaks on a given rod,
you may use the same LB for all.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># Sample data file with Bragg peak position and spacing</span>
<span class="c1"># H       K       L       I       Ierr    LB      dL</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.0</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.1</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.2</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.3</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.4</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.5</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
<span class="mi">0</span> <span class="mi">0</span>       <span class="mf">1.6</span>     <span class="mi">0</span>       <span class="mi">0</span>       <span class="mi">3</span>       <span class="mi">3</span>
</pre></div>
</div>
</li>
<li><p class="first">SXRD model script modified to include the beta parameter as a user variable, and
roughness in the structure factor calculation. Add/replace the following code in the model script
shown at <a class="reference internal" href="sxrd.html#tutorial-sxrd"><span class="std std-ref">Surface X-diffraction tutorial</span></a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># 3.a Define beta for roughness model</span>
<span class="n">rgh</span><span class="o">=</span><span class="n">UserVars</span><span class="p">()</span>
<span class="n">rgh</span><span class="o">.</span><span class="n">new_var</span><span class="p">(</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>


<span class="c1"># 9 Define the Sim function</span>
<span class="k">def</span> <span class="nf">Sim</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
   <span class="n">I</span> <span class="o">=</span> <span class="p">[]</span>
   <span class="n">beta</span> <span class="o">=</span> <span class="n">rgh</span><span class="o">.</span><span class="n">beta</span>
   <span class="c1">#9.a loop through the data sets</span>
   <span class="k">for</span> <span class="n">data_set</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
      <span class="c1"># 9.b create all the h,k,l,LB,dL values for the rod (data_set)</span>
      <span class="n">h</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">extra_data</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span>
      <span class="n">k</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">extra_data</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span>
      <span class="n">l</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">x</span>
      <span class="n">LB</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">extra_data</span><span class="p">[</span><span class="s1">&#39;LB&#39;</span><span class="p">]</span>
      <span class="n">dL</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">extra_data</span><span class="p">[</span><span class="s1">&#39;dL&#39;</span><span class="p">]</span>
      <span class="c1"># 9.c. calculate roughness using beta model</span>
      <span class="n">rough</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">LB</span><span class="p">)</span><span class="o">/</span><span class="n">dL</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
      <span class="c1"># 9.d. Calculate the structure factor</span>
      <span class="n">f</span> <span class="o">=</span> <span class="n">rough</span><span class="o">*</span><span class="n">sample</span><span class="o">.</span><span class="n">calc_f</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
      <span class="c1"># 9.e Calculate |F|</span>
      <span class="n">i</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
      <span class="c1"># 9.f Append the calculated intensity to the list I</span>
      <span class="n">I</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">I</span>
</pre></div>
</div>
</li>
<li><p class="first">In your parameter grid, select an empty row, right click, and select <span class="menuselection">UserVars‣rgh.setBeta</span></p>
</li>
</ol>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="rob86" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[ROB86]</a></td><td>ROBINSON, I., 1986. CRYSTAL TRUNCATION RODS AND SURFACE-ROUGHNESS. Physical Review B 33, 3830-3836.</td></tr>
</tbody>
</table>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/tutorials/beta_rough.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright 2017, Matts Björck.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>